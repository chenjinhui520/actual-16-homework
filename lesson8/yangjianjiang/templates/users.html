<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Reboot Actual 16</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <meta content="Preview page of Metronic Admin Theme #1 for blank page layout" name="description" />
        <meta content="" name="author" />
		
        <link href="/static/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <link href="/static/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
        <!--<link href="/static/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />-->
        <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link href="/static/layouts/layout/css/layout.min.css" rel="stylesheet" type="text/css" />
        <link href="/static/layouts/layout/css/themes/darkblue.min.css" rel="stylesheet" type="text/css" id="style_color" />
        <link href="/static/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
	<link href="/static/imgs/favicon.ico" rel="shortcut icon" /> 

        <style>
            @media (min-width: 768px){
                .navbar-nav>li>a {
                    padding-top: 10px;
                    padding-bottom: 11px;
                }
            }
        </style>
	</head>

    <body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">
        <!--模态框开始-->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h2 class="modal-title" id="myModalLabel">
                            <center>请输入注册信息</center>
                        </h2>
                    </div>
                    <div class="modal-body form-group srkuang">
                        <label> 用户名</label>
                        <input id='name' class='form-control' placeholder="请输入用户名" required autofocus>
                        <div class="namemsg" style="color:red"></div>
                        <label> 密码</label>
                        <input id='passwd' type='password' class='form-control' placeholder="请输入密码">
                        <label> 确认密码</label>
                        <input id='rpasswd' type='password' class='form-control' placeholder="再次确认密码">
                        <div class="pwdmsg" style="color:red"></div>
                        <label> 邮箱</label>
                        <input id='email' type="email" class='form-control' placeholder="请输入邮箱"  name="email" required autofocus>
                        <div class="emailmsg" style="color:red"></div>
                    </div>
                    <div class="modal-footer">
                    <center>
                        <button type="button" class="btn btn-danger" data-dismiss="modal">关闭</button>
                        <button id='btnsave' type="button" class="btn btn-success">提交</button>
                        </center>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </div>
        <!--  模态框结束-->

        <div class="page-wrapper">
            <div class="page-header navbar navbar-fixed-top">
                <div class="page-header-inner ">
                    <div class="page-logo">
                        <a href="/">
                            <img src="/static/layouts/layout/img/logo.png" alt="logo" class="logo-default" /> </a>
                        <div class="menu-toggler sidebar-toggler">
                            <span></span>
                        </div>
                    </div>
                    <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse">
                        <span></span>
                    </a>
                        <ul class="nav navbar-nav pull-right">
                            <li class="dropdown dropdown-user">
                                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                                    <img alt="" class="img-circle" src="/static/layouts/layout/img/avatar3_small.jpg" />
                                    <span class="username username-hide-on-mobile"> actual6 </span>
                                    <i class="fa fa-angle-down"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-default">
                                    <li>
                                        <a href="/logout"><i class="icon-key"></i> 退出 </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="clearfix"> </div>

            <div class="page-container">
                <div class="page-sidebar-wrapper">
                    <div class="page-sidebar navbar-collapse collapse">
                        <ul class="page-sidebar-menu  page-header-fixed " data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200" style="padding-top: 20px">
                            <li class="sidebar-toggler-wrapper hide">
                                <div class="sidebar-toggler">
                                    <span></span>
                                </div>
                            </li>
                            <li class="nav-item  ">
                                <a href="javascript:;" class="nav-link nav-toggle">
                                    <i class="icon-diamond"></i>
                                    <span class="title">用户管理</span>
                                    <span class="arrow"></span>
                                </a>
                                <ul class="sub-menu">
                                    <li class="nav-item  ">
                                        <a href="/users" class="nav-link ">
                                            <span class="title">用户列表</span>
                                        </a>
                                    </li>
                                    <li class="nav-item  ">
                                        <a href="ui_colors.html" class="nav-link ">
                                            <span class="title">用户组</span>
                                        </a>
                                    </li>
                                    <li class="nav-item  ">
                                        <a href="ui_bootbox.html" class="nav-link ">
                                            <span class="title">用户权限</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="nav-item  ">
                                <a href="javascript:;" class="nav-link nav-toggle">
                                    <i class="icon-puzzle"></i>
                                    <span class="title">资源管理</span>
                                    <span class="arrow"></span>
                                </a>
                                <ul class="sub-menu">
                                    <li class="nav-item  ">
                                        <a href="/assets" class="nav-link ">
                                            <span class="title">资产管理</span>
                                        </a>
                                    </li>
                                    <li class="nav-item  ">
                                        <a href="components_color_pickers.html" class="nav-link ">
                                            <span class="title">域名管理</span>
                                            <span class="badge badge-danger">2</span>
                                        </a>
                                    </li>
                                    <li class="nav-item  ">
                                        <a href="components_bootstrap_switch.html" class="nav-link ">
                                            <span class="title">控制系统</span>
                                            <span class="badge badge-success">6</span>
                                        </a>
                                    </li>
                    
                                </ul>
                            </li>
                            <li class="nav-item  ">
                                <a href="javascript:;" class="nav-link nav-toggle">
                                    <i class="icon-settings"></i>
                                    <span class="title">性能监控</span>
                                    <span class="arrow"></span>
                                </a>
                                <ul class="sub-menu">
                                    <li class="nav-item  ">
                                        <a href="/performance_monitor" class="nav-link ">
                                            <span class="title">主机监控
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="page-content-wrapper">
                    <div class="page-content">
					
                        <div class="page-bar">
                            <ul class="page-breadcrumb">
                                <li>
                                    <a href="/">Home</a>
                                    <i class="fa fa-angle-right"></i>
                                </li>
                                <li>
                                    <span>用户管理</span>
                                </li>
                            </ul>
                        </div>
                        
						
						 <div class="row">
							<div class="col-md-12">
							
								<div class="portlet light">
									<div class="portlet-body">
										<div class="table-toolbar">
											
											<div class="btn-group pull-left">
                                                <!--	<a href="/users/add"> -->
                                                <!--<button data-toggle="modal" -->
												<button class="btn btn-circle orange btn-outline regbtn"> 添加用户
													<i class="fa fa-plus"></i>
												</button>
												</a>
											</div>

											<div class="btn-group pull-right">
												<form class="form-inline" style="float: right" method="get" action="/users">
												    <div class="form-group">
												    	<input class="form-control" type="text" name="search" placeholder="搜索" autocomplete="off">
														<button type="submit" class="btn btn-primary">查询</button>
												    </div>	
												</form>
											</div>
											
										</div>
									
										<div class="portlet">
											<div class="portlet-body">
												<div class="table-scrollable">
													<table id="tbss" class="table table-striped table-bordered table-advance table-hover">
														<thead>
															<tr>
																<th>#</th>
																<th>用户名</th>
																<th>密码</th>
																<th>邮箱</th>
																<th>操作</th>
															</tr>
														</thead>
														<tbody>
															{% for user in users %}
																<tr>
																	<td class="highlight">
																		<div class="info"> </div>
																		<a href="javascript:;"> {{ user[0] }} </a>
																	</td>
																	<td class="hidden-xs"> {{ user[1] }}</td>
																	<td class="hidden-xs"> {{ user[2] }} </td>
																	<td> {{ user[3] }} </td>
																	<td>
    <button class="fa fa-edit btn btn-outline btn-circle green btn-sm purple editbtn" uid={{ user[0]}} >修改</button>
	<a href="/users/{{ user[0] }} " class="btn btn-outline btn-circle dark btn-sm red">
																			<i class="fa fa-trash-o"></i> 删除 </a>
																	</td>
																</tr>
															 {% endfor %}	
														</tbody>
													</table>
												</div>
											</div>
								        </div>
									</div>
								</div>
							</div>
						</div>
					</div>
                </div>
            </div>

			<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
				  <div class="modal-dialog modal-lg" role="document">
				      <div class="modal-content">
						  <input type='text'> 用户名:<br/>
						  <input type='text'> 用户名:<br/>
						  <input type='text'> 用户名:<br/>
						  <input type='text'> 用户名:<br/>
					  </div>
				  </div>
			</div>


            <div class="page-footer">
                <div class="page-footer-inner"> 2017 &copy; monkey. All rights reserved.</div>
                <div class="scroll-to-top">
                    <i class="icon-arrow-up"></i>
                </div>
            </div>
        </div>
      
        <!-- BEGIN CORE PLUGINS -->
        <script src="/static/global/plugins/jquery.min.js" type="text/javascript"></script>
        <script src="/static/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="/static/global/plugins/js.cookie.min.js" type="text/javascript"></script>
        <script src="/static/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
        <script src="/static/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
        <script src="/static/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
        <script src="/static/global/scripts/app.min.js" type="text/javascript"></script>
        <script src="/static/layouts/layout/scripts/layout.min.js" type="text/javascript"></script>
        <script src="/static/layouts/layout/scripts/demo.min.js" type="text/javascript"></script>
        <script src="/static/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script>
        <script src="/static/layouts/global/scripts/quick-nav.min.js" type="text/javascript"></script>
		<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        
        <!-- END THEME LAYOUT SCRIPTS -->
        <script>
            $(document).ready(function()
            {
                $('#clickmewow').click(function()
                {
                    $('#radio1003').attr('checked', 'checked');
                });
     //模态框js开始
         $('.regbtn').click(function(){
                 // 弹起模态框
                 $('#myModal').modal('show')

                //判断用户名是否已存在
                        $('#name').change(function(){
                            username = $('#name').val()
                            type = 'POST'
                            url = '/checkusername'
                            data1 = {"username":username}
                            //console.log(data1)
                            $.ajax({
                                type:type,
                                url:url,
                                data:data1,
                                dataType:"json",
                                success:function(data1){
                                    console.log(data1)
                                        if (data1.status == 1){
                                        $('.namemsg').html('输入的用户名已存在，请更换用户名！')
                                        
                                        }
                                        else{
                                        $('.namemsg').hide()
                                        }
                                    },
                                error:function(){
                                   },
                                })
                        
                        })

                        //判断邮箱格式
                 // 点击模态框的保存按钮，发送数据到后端 完成修改
                 $('#btnsave').click(function(){
                 // 获取模态框修改后的值
                 username = $('#name').val()
                 passwd = $('#passwd').val()
                 rpasswd = $('#rpasswd').val()
                 email = $('#email').val()
                 
                        //判断两次输入密码是否一致
                        if (username == ""){
                             $('.namemsg').html('用户名不能为空！')
                             return false
                        }
                        else{
                             $('.namemsg').hide()
                        
                        }
                        if( passwd == ""){
                             $('.pwdmsg').html('密码不能为空！')
                             return false
                        }
                        else{
                             $('.pwdmsg').hide()
                        
                        } 
                        if (email == ""){
                             $('.emailmsg').html('邮箱不能为空！')
                             return false
                        }
                        else{
                             $('.emailmsg').hide()
                        
                        }
                    
                        if (passwd != rpasswd ){
                             $('.pwdmsg').html('两次输入的密码不一致，请重新输入！')
                             return false
                         }
                        else{
                             $('.pwdmsg').hide()
                        }


                        //判断邮箱格式是否正确
                       // if (email.indexOf("@") ){
                       //      $('.emailmsg').html('输入的邮箱格式不正确，请重新输入！')
                       //      return false
                       //  }

                     type = 'POST'    // GET,POST,DELETE,PUT, ...
                     url = '/users'
                     data = {username:username,password:passwd, email:email }
                     console.log(data)
         $.ajax({
                type: type,
                url: url,
                data: data,
                dataType: "json",
                success: function(data){
                //逻辑
                location.reload()
                    },
                error: function(){
                         //显示错误信息
                     },
             })
              })
     //模态框js结束
            })
	$('.editbtn').click(function(){
		// 获取table编辑按钮这一行的 用户名 邮箱 密码 的值
		id = $(this).attr('uid')
		var username = $(this).parents("tr").children("td").eq(1).text()
		var passwd = $(this).parents("tr").children("td").eq(2).text()
		var rpasswd = $(this).parents("tr").children("td").eq(2).text()
		var email = $(this).parents("tr").children("td").eq(3).text()
		// 弹起模态框
		$('#myModal').modal('show')
		// 把值写入模态框的各个input
		$('#name').attr('value', username.trim())
		$('#passwd').attr('value', passwd.trim())
		$('#rpasswd').attr('value', rpasswd.trim())
		$('#email').attr('value', email.trim())

		// 点击模态框的保存按钮，发送数据到后端 完成修改
		$('#btnsave').click(function(){
		// 获取模态框修改后的值
		username = $('#name').val()
		passwd = $('#passwd').val()
		rpasswd = $('#rpasswd').val()
		email = $('#email').val()

        console.log(username)
        console.log(passwd)
        console.log(username)
        if (username == ""){
           $('.namemsg').html('用户名不能为空！')
           return false
          }
         else{
             $('.namemsg').hide()
        
        }
        if( passwd == ""){
             $('.pwdmsg').html('密码不能为空！')
             return false
        }
        else{
             $('.pwdmsg').hide()
        
        } 
        if (email == ""){
             $('.emailmsg').html('邮箱不能为空！')
             return false
        }
        else{
             $('.emailmsg').hide()
        
        }
        
        if (passwd != rpasswd ){
             $('.pwdmsg').html('两次输入的密码不一致，请重新输入！')
             return false
         }
        else{
             $('.pwdmsg').hide()
        }

		type = 'POST'    // GET,POST,DELETE,PUT, ...
    	url = '/users/edit'
    	data = {username:username,password:passwd, email:email, id:id }
	    console.log(data)

    		    $.ajax({
             		type: type,
             		url: url,
             		data: data,
             		dataType: "json",
             		success: function(data){
              		//逻辑
				location.reload()
             		},
	     		error: function(){
	     		//显示错误信息
	     	},
            })
        })
    })

            })




        </script>
    </body>

</html>
